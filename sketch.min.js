var center,p,upPosition,goesUp,left,prevPoint,point,DEBUG=!1,blockSize=600,SIZE=Math.floor(blockSize/8),colors=["Yellow","LightSkyBlue","LightSlateGrey","LightSteelBlue","LightGrey","YellowGreen"],MARGIN=3,path=[],direction=[];function getRoom(row,column,limit,dir){var room;column===upPosition?room=0===row?0:3:goesUp?room=4:5===Math.floor(random(0,6))||column===limit?(left=column===limit?dir:.5<=Math.random(),room=3===row?5:2,goesUp=!0,upPosition=column):room=1;return room}function fillGrid(){for(var j=0;j<4;j++){if(direction.push(left),goesUp=!1,p=[],left)for(var i=0;i<4;i++)p[i]=0<j&&i<upPosition?4:getRoom(j,i,3,!1);else for(i=3;0<=i;i--)p[i]=0<j&&upPosition<i?4:getRoom(j,i,0,!0);path.push(p)}}function drawTriangle(pos,room,dir){var a,b,c;c=2===room?(a=createVector(pos.x-5,pos.y+5),b=createVector(pos.x,pos.y-5),createVector(pos.x+5,pos.y+5)):dir?(a=createVector(pos.x-5,pos.y+5),b=createVector(pos.x-5,pos.y-5),createVector(pos.x+5,pos.y)):(a=createVector(pos.x-5,pos.y),b=createVector(pos.x+5,pos.y-5),createVector(pos.x+5,pos.y+5)),triangle(a.x,a.y,b.x,b.y,c.x,c.y)}function drawGrid(row,column){4===path[row][column]?(noStroke(),fill(colors[path[row][column]])):(strokeWeight(1),noFill(),stroke(colors[path[row][column]]));var m=createVector(column*MARGIN,row*MARGIN),pos=createVector(center.x+SIZE*column+m.x,center.y+SIZE*(4-row)-m.y);rect(pos.x,pos.y,SIZE,SIZE),4!==path[row][column]&&(point=createVector(pos.x+SIZE/2,pos.y+SIZE/2),prevPoint&&(strokeWeight(1),stroke("LightGrey"),line(prevPoint.x,prevPoint.y,point.x,point.y)),noStroke(),fill("LightGrey"),drawTriangle(point,path[row][column],direction[row])),prevPoint=point}function setup(){createCanvas(windowWidth,windowHeight,P2D).parent("content"),center=createVector(windowWidth/2-2*SIZE,windowHeight/2-3*SIZE),DEBUG?noLoop():frameRate(1)}function draw(){background(255),point=prevPoint=null,left=.5<=Math.random(),path=[],direction=[],upPosition=left?0:3,fillGrid();for(var i=0;i<4;i++)if(direction[i])for(var j=0;j<4;j++)drawGrid(i,j);else for(j=3;0<=j;j--)drawGrid(i,j);if(DEBUG){var prettyPrintPath="";for(i=3;0<=i;i--){for(j=0;j<4;j++)prettyPrintPath+=" "+path[i][j];console.log("p"+i+(direction[i]?" -> ":" <- ")+prettyPrintPath),prettyPrintPath=""}}}